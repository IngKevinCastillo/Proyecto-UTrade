<div class="topbar d-flex align-items-center justify-content-between px-4 py-2">
  <input class="search-input" type="text" placeholder="Buscar" />

  <div class="filters d-flex gap-3">
    <button class="filter-btn" routerLink="/compras" routerLinkActive="active">
      Compras
    </button>
    <button class="filter-btn" routerLink="/rentas" routerLinkActive="active">
      Rentas
    </button>
  </div>

  <div class="profile-container position-relative">
    <div class="d-flex align-items-center gap-3 me-4" (click)="toggleNotificacion($event)">
      <app-notification-icon [notificationCount]="notificationCount"></app-notification-icon>
    </div>

    <div *ngIf="notificaciones" class="user-menu">
      <ul class="menu-list">
        <li class="menu-item" *ngFor="let noti of listaNotificaciones.slice(0, 5)">
          <i class="bi bi-bell menu-icon"></i>
          <div>
            <div style="font-weight: 600;">{{ noti.nombre }}</div>
            <div style="font-size: 12px; opacity: 0.7;">{{ noti.tipo }}</div>
          </div>
        </li>
        <li class="menu-item text-center" (click)="verTodasNotificaciones()">
          <strong>Ver todas las notificaciones</strong>
        </li>
      </ul>
    </div>

    <div class="d-flex align-items-center gap-3" (click)="toggleMenu($event)">
      <app-user-profile
        [username]="username"
        [userHandle]="userHandle"
        [avatarUrl]="avatarUrl"
      ></app-user-profile>
      <i class="dropdown-icon" [ngClass]="{ rotated: menuVisible }"></i>
    </div>

    <div *ngIf="menuVisible" class="user-menu">
      <ul class="menu-list">
        <li class="menu-item" (click)="editProfile()">
          <i class="bi bi-pencil menu-icon"></i>
          <span>Editar perfil</span>
        </li>
        <li class="menu-item" (click)="changePassword()">
          <i class="bi bi-key menu-icon"></i>
          <span>Cambiar contraseña</span>
        </li>
        <li class="menu-item" (click)="toggleTheme()">
          <i class="bi bi-brightness-high menu-icon"></i>
          <span>Alternar tema</span>
        </li>
        <li class="menu-item" (click)="logout()">
          <i class="bi bi-box-arrow-right menu-icon"></i>
          <span>Cerrar sesión</span>
        </li>
      </ul>
    </div>
  </div>
</div>
